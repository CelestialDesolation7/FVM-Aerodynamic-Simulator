# NRBC构造问题解决日志

守恒方程具有波的性质。
$$
\frac{\partial u}{\partial t} = - c \cdot \frac{\partial u}{\partial x}
$$
理解1：我现在这个位置（$x$）的水位随时间的变化率（$\partial u/\partial t$），等于上游流过来的水量的梯度（$\partial u/\partial x$）。

理解2：在拉动一张桌布。 这个方程的数学解是 $u(x,t) = f(x - ct)$。 这意味着：**现在的波形，和一秒前的波形长得一模一样，只是向右平移了 $c$ 米。**

https://www.zhihu.com/question/23082200

## 1. 引入

最简单的**标量对流方程**：
$$
\frac{\partial \phi}{\partial t} + c \frac{\partial \phi}{\partial x} = 0
$$
其中 $\phi$ 是我们要守恒的量（比如液体质量），$c$ 是常数。 $\phi$ 的表达式是一个关于 $t$ 和 $x$ 的函数。这个函数的形式我们不知道，需要“求解”。这样一来，我们只需要知道 $t$ 和 $x$ ，就可以知道对应的 $\phi$ 。

也就是说，我们通过利用守恒方程，求得了一个物理场。

求证：这个方程的解一定是 $\phi(x,t) = f(x - ct)$ 形式的波。

**证明过程（链式法则）：** 假设解的形式就是 $\phi(x,t) = f(\xi)$，其中 $\xi = x - ct$。 我们来验证它是否满足方程。

1. **对时间 $t$ 求导**：
	$$
	\frac{\partial \phi}{\partial t} = \frac{df}{d\xi} \cdot \frac{\partial \xi}{\partial t} = f'(\xi) \cdot (-c) = -c f'(\xi)
	$$

2. **对空间 $x$ 求导**：
	$$
	\frac{\partial \phi}{\partial x} = \frac{df}{d\xi} \cdot \frac{\partial \xi}{\partial x} = f'(\xi) \cdot (1) = f'(\xi)
	$$

3. **代回原方程**：
	$$
	\text{左边} = (-c f'(\xi)) + c \cdot (f'(\xi)) = 0
	$$

**结论：**

是的！只要满足这个方程，数学上它的解**必须**保持 $f(x-ct)$ 的形式。

物理上这意味着：**$t=0$ 时的形状 $f(x)$，在 $t$ 时刻原封不动地平移到了 $ct$ 的位置。这就是波。**

## 2. 推广

流体力学（忽略粘性的 N-S 方程，即欧拉方程）：

欧拉方程包含两个守恒：

1. **质量守恒**：$\frac{\partial \rho}{\partial t} + \frac{\partial (\rho u)}{\partial x} = 0$
2. **动量守恒**：$\frac{\partial (\rho u)}{\partial t} + \frac{\partial (\rho u^2 + p)}{\partial x} = 0$

可以用矩阵重写为：
$$
\frac{\partial \mathbf{V}}{\partial t} + \mathbf{A} \frac{\partial \mathbf{V}}{\partial x} = 0，其中\begin{array}{c} \mathbf{V} = \begin{pmatrix} \rho \\ u \end{pmatrix} \end{array}，\begin{array}{c} \mathbf{A} = \begin{pmatrix} u & \rho \\ c^2/\rho & u \end{pmatrix} \end{array}
$$


对矩阵特征值分解：
$$
\mathbf{A} = \mathbf{R} \mathbf{\Lambda} \mathbf{L}
$$
$\mathbf{\Lambda}$：**对角矩阵**（对角线上是特征值 $\lambda_1, \lambda_2$）。

$\mathbf{L}$：左特征向量矩阵。

$\mathbf{R}$：右特征向量矩阵。

我们把原方程左乘 $\mathbf{L}$：

$$\mathbf{L} \frac{\partial \mathbf{V}}{\partial t} + \mathbf{L} \mathbf{A} \frac{\partial \mathbf{V}}{\partial x} = 0$$

代入 $A = R \Lambda L$，并利用 $L \cdot R = I$（单位矩阵）：

$$\mathbf{L} \frac{\partial \mathbf{V}}{\partial t} + \mathbf{\Lambda} (\mathbf{L} \frac{\partial \mathbf{V}}{\partial x}) = 0$$

**定义新变量（特征变量）** $\mathbf{W} = \mathbf{L} \mathbf{V}$。

假设 $A$ 是常数矩阵（局部线性化），导数可以放进括号里：

$$\frac{\partial \mathbf{W}}{\partial t} + \mathbf{\Lambda} \frac{\partial \mathbf{W}}{\partial x} = 0$$

展开来看，因为 $\Lambda$ 是对角的：

$$\begin{pmatrix} \frac{\partial w_1}{\partial t} \\ \frac{\partial w_2}{\partial t} \end{pmatrix} + \begin{pmatrix} \lambda_1 & 0 \\ 0 & \lambda_2 \end{pmatrix} \begin{pmatrix} \frac{\partial w_1}{\partial x} \\ \frac{\partial w_2}{\partial x} \end{pmatrix} = 0$$

这等价于两个**完全独立**的方程：

1. **波 1**： $\frac{\partial w_1}{\partial t} + \lambda_1 \frac{\partial w_1}{\partial x} = 0$
2. **波 2**： $\frac{\partial w_2}{\partial t} + \lambda_2 \frac{\partial w_2}{\partial x} = 0$

这意味着欧拉方程的解一定满足以下形式：
$$
w_1(x,t) = f_1(x - (u+c)t) \\
w_2(x,t) = f_2(x - (u-c)t)
$$
 其中 $w_1$ 和 $w_2$ 是原始变量的组合，这是换元法。

## 3. 正题

根据资料，二维有粘性 Navier-Stocks方程的解为：

#### $\mathcal{L}_1$：熵波 (Entropy Wave)

描述密度（温度）随流体移动的变化，不产生压力波动。

$$\mathcal{L}_1 = \lambda_1 \left( \frac{\partial \rho}{\partial y} - \frac{1}{c^2} \frac{\partial p}{\partial y} \right)$$

#### $\mathcal{L}_2$：剪切波 (Shear / Vorticity Wave)

描述横向速度 $u$ 随纵向流体移动的变化。注意这里出现的是 $u$，因为它是随 $v$ 漂移的“横向信息”。

$$\mathcal{L}_2 = \lambda_2 \left( \frac{\partial u}{\partial y} \right)$$

#### $\mathcal{L}_3$：向上声波 (Upstream Acoustic Wave)

描述沿 Y 轴正方向传播的压力波。

$$\mathcal{L}_3 = \lambda_3 \left( \frac{\partial p}{\partial y} + \rho c \frac{\partial v}{\partial y} \right)$$

#### $\mathcal{L}_4$：向下声波 (Downstream Acoustic Wave)

描述沿 Y 轴负方向传播的压力波。

$$\mathcal{L}_4 = \lambda_4 \left( \frac{\partial p}{\partial y} - \rho c \frac{\partial v}{\partial y} \right)$$

**$\lambda_1 = v$**：流体整体移动的速度（携带密度/温度信息）。

**$\lambda_2 = v$**：流体整体移动的速度（携带横向剪切/涡量信息）。

**$\lambda_3 = v + c$**：向上跑的声波（声速 $c$ 叠加流速 $v$）。

**$\lambda_4 = v - c$**：向下跑的声波（声速 $c$ 反向叠加流速 $v$）。

















